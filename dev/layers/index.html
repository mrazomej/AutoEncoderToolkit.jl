<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Custom Layers · AutoEncoderToolkit</title><meta name="title" content="Custom Layers · AutoEncoderToolkit"/><meta property="og:title" content="Custom Layers · AutoEncoderToolkit"/><meta property="twitter:title" content="Custom Layers · AutoEncoderToolkit"/><meta name="description" content="Documentation for AutoEncoderToolkit."/><meta property="og:description" content="Documentation for AutoEncoderToolkit."/><meta property="twitter:description" content="Documentation for AutoEncoderToolkit."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="AutoEncoderToolkit logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="AutoEncoderToolkit logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">AutoEncoderToolkit</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../encoders/">Encoders &amp; Decoders</a></li><li class="is-active"><a class="tocitem" href>Custom Layers</a><ul class="internal"><li><a class="tocitem" href="#reshape"><span><code>Reshape</code></span></a></li><li><a class="tocitem" href="#flatten"><span><code>Flatten</code></span></a></li><li><a class="tocitem" href="#ActivationOverDims"><span><code>ActivationOverDims</code></span></a></li></ul></li><li><a class="tocitem" href="../ae/">Deterministic Autoencoders</a></li><li><a class="tocitem" href="../vae/">VAE / β-VAE</a></li><li><a class="tocitem" href="../mmdvae/">MMD-VAE (InfoVAE)</a></li><li><a class="tocitem" href="../infomaxvae/">InfoMax-VAE</a></li><li><a class="tocitem" href="../hvae/">HVAE</a></li><li><a class="tocitem" href="../rhvae/">RHVAE</a></li><li><a class="tocitem" href="../diffgeo/">Differential Geometry</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li><li><a class="tocitem" href="../guidelines/">Community Guidelines</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Custom Layers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Custom Layers</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Custom-Layers"><a class="docs-heading-anchor" href="#Custom-Layers">Custom Layers</a><a id="Custom-Layers-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Layers" title="Permalink"></a></h1><p><code>AutoEncoderToolkit.jl</code> provides a set of commonly-used custom layers for building autoencoders. These layers need to be explicitly defined if you want to save a train model and load it later. For example, if the input to the encoder is an image in format <code>HWC</code> (height, width, channel), somewhere in the encoder there must be a function that flattens its input to a vector for the mapping to the latent space to be possible. If you were to define this with a simple function, the libraries to save the the model such as <code>JLD2</code> or <code>BSON</code> would not work with these anonymous function. This is why we provide this set of custom layers that play along these libraries.</p><h2 id="reshape"><a class="docs-heading-anchor" href="#reshape"><code>Reshape</code></a><a id="reshape-1"></a><a class="docs-heading-anchor-permalink" href="#reshape" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.Reshape" href="#AutoEncoderToolkit.Reshape"><code>AutoEncoderToolkit.Reshape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reshape(shape)</code></pre><p>A custom layer for Flux that reshapes its input to a specified shape.</p><p>This layer is useful when you need to change the dimensions of your data within a Flux model. Unlike the built-in reshape operation in Julia, this custom layer can be saved and loaded using packages such as BSON or JLD2.</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>: The target shape. This can be any tuple of integers and colons. Colons are used to indicate dimensions whose size should be inferred such that the total number of elements remains the same.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; r = Reshape(10, :)
Reshape((10, :))

julia&gt; r(rand(5, 2))
10×1 Matrix{Float64}:</code></pre><p><strong>Note</strong></p><p>When saving and loading the model, make sure to include Reshape in the list of layers to be processed by BSON or JLD2.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.Reshape-Tuple{AbstractArray}" href="#AutoEncoderToolkit.Reshape-Tuple{AbstractArray}"><code>AutoEncoderToolkit.Reshape</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Reshape(args...)</code></pre><p>Constructor for the Reshape struct that takes variable arguments.</p><p>This function allows us to create a Reshape instance with any shape.</p><p><strong>Arguments</strong></p><ul><li><code>args...</code>: Variable arguments representing the dimensions of the target shape.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Reshape</code> instance with the target shape set to the provided dimensions.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; r = Reshape(10, :)
Reshape((10, :))</code></pre></div></section><section><div><p>(r::Reshape)(x)</p><p>This function is called during the forward pass of the model. It reshapes the input <code>x</code> to the target <code>shape</code> stored in the Reshape instance <code>r</code>.</p><p><strong>Arguments</strong></p><ul><li><code>r::Reshape</code>: An instance of the Reshape struct.</li><li><code>x</code>: The input to be reshaped.</li></ul><p><strong>Returns</strong></p><ul><li>The reshaped input.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; r = Reshape(10, :)
Reshape((10, :))

julia&gt; r(rand(5, 2))
10×1 Matrix{Float64}:
 ...</code></pre></div></section></article><h2 id="flatten"><a class="docs-heading-anchor" href="#flatten"><code>Flatten</code></a><a id="flatten-1"></a><a class="docs-heading-anchor-permalink" href="#flatten" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.Flatten" href="#AutoEncoderToolkit.Flatten"><code>AutoEncoderToolkit.Flatten</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Flatten()</code></pre><p>A custom layer for Flux that flattens its input into a 1D vector.</p><p>This layer is useful when you need to change the dimensions of your data within a Flux model. Unlike the built-in flatten operation in Julia, this custom layer can be saved and loaded by packages such as BSON and JLD2.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; f = Flatten()

julia&gt; f(rand(5, 2))
10-element Vector{Float64}:</code></pre><p><strong>Note</strong></p><p>When saving and loading the model, make sure to include Flatten in the list of layers to be processed by BSON or JLD2.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.Flatten-Tuple{AbstractArray}" href="#AutoEncoderToolkit.Flatten-Tuple{AbstractArray}"><code>AutoEncoderToolkit.Flatten</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(f::Flatten)(x)</code></pre><p>This function is called during the forward pass of the model. It flattens the input x into a 1D vector.</p><p><strong>Arguments</strong></p><ul><li><code>f::Flatten</code>: An instance of the Flatten struct.</li><li><code>x</code>: The input to be flattened.</li></ul><p><strong>Returns</strong></p><p>The flattened input.</p></div></section></article><h2 id="ActivationOverDims"><a class="docs-heading-anchor" href="#ActivationOverDims"><code>ActivationOverDims</code></a><a id="ActivationOverDims-1"></a><a class="docs-heading-anchor-permalink" href="#ActivationOverDims" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.ActivationOverDims" href="#AutoEncoderToolkit.ActivationOverDims"><code>AutoEncoderToolkit.ActivationOverDims</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ActivationOverDims(σ::Function, dims::Int)</code></pre><p>A custom layer for Flux that applies an activation function over specified dimensions.</p><p>This layer is useful when you need to apply an activation function over specific dimensions of your data within a Flux model. Unlike the built-in activation functions in Julia, this custom layer can be saved and loaded using the BSON or JLD2 package.</p><p><strong>Arguments</strong></p><ul><li><code>σ::Function</code>: The activation function to be applied.</li><li><code>dims</code>: The dimensions over which the activation function should be applied.</li></ul><p><strong>Note</strong></p><p>When saving and loading the model, make sure to include <code>ActivationOverDims</code> in the list of layers to be processed by BSON or JLD2.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AutoEncoderToolkit.ActivationOverDims-Tuple{AbstractArray}" href="#AutoEncoderToolkit.ActivationOverDims-Tuple{AbstractArray}"><code>AutoEncoderToolkit.ActivationOverDims</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(σ::ActivationOverDims)(x)</code></pre><p>This function is called during the forward pass of the model. It applies the activation function <code>σ.σ</code> over the dimensions <code>σ.dims</code> of the input <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><code>σ::ActivationOverDims</code>: An instance of the ActivationOverDims struct.</li><li><code>x</code>: The input to which the activation function should be applied.</li></ul><p><strong>Returns</strong></p><ul><li>The input <code>x</code> with the activation function applied over the specified dimensions.</li></ul><p><strong>Note</strong></p><p>This custom layer can be saved and loaded using the BSON package. When saving and loading the model, make sure to include <code>ActivationOverDims</code> in the list of layers to be processed by BSON or JLD2.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../encoders/">« Encoders &amp; Decoders</a><a class="docs-footer-nextpage" href="../ae/">Deterministic Autoencoders »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 11 July 2024 20:09">Thursday 11 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
